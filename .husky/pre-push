#!/bin/sh

echo "ğŸš€ Running pre-push checks..."

# 1. Type-check
echo "ğŸ“ TypeScript type-check..."
npm run typecheck
if [ $? -ne 0 ]; then
  echo "âŒ TypeScript type-check failed!"
  exit 1
fi

# 2. Lint
echo "ğŸ” ESLint..."
npm run lint
if [ $? -ne 0 ]; then
  echo "âŒ ESLint failed!"
  exit 1
fi

# 3. Build
echo "ğŸ”¨ Build..."
npm run build
if [ $? -ne 0 ]; then
  echo "âŒ Build failed!"
  exit 1
fi

# 4. Unit tests
echo "ğŸ§ª Running unit tests..."
npm run test:unit
if [ $? -ne 0 ]; then
  echo "âŒ Unit tests failed!"
  exit 1
fi

# 5. Knip - check for unused code (advisory only)
echo "ğŸ”¬ Checking for unused code (knip)..."
if ! npm run knip; then
  echo "âš ï¸  Knip reported unused code (non-blocking; please review before merging)"
fi

echo "âœ… All checks passed!"
